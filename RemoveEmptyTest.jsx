// Product: NIKE Golf RGB Color Assignment// Created by Matthew Hauth, PGA & Microbrew Media, LLC// Web: www.MicrobrewMedia.com// Version: 1.0.2// Description: Run via InDesign CC after Swatches have been imported + DataMerge has been completed on Master Template// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR// PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE// FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER// DEALINGS IN THE SOFTWARE.#target indesignmain(); // Run the Functionfunction main() {  var theDoc = app.activeDocument; // active doc  var thePage = theDoc.pages.item(0); // first page  var totalPages = theDoc.pages.length;  var endingPage = totalPages - 1;  var startingPage = 1; // The desired number of the first actual page  var actualStartPage = startingPage - 1;  var actualPage = startingPage;  var theLayers = theDoc.layers;  var layersTotal = theLayers.length;  var startLayer = 0; // really the first layers theLayers.item(0)  var endLayer = layersTotal;  var currentLayer = theDoc.activeLayer;  var theSwatches = theDoc.swatches;  var cSwatches = theSwatches.everyItem().name.join("@$@");  app.activeWindow.activePage = app.activeDocument.pages.item(actualStartPage); // Set Active Page  theDoc.activeLayer = theDoc.layers[0]; // Set to Bottom Layer 0    function findSwatch(PartOfName) {    rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g; // Clear a few Unicode Characters    PartOfName = PartOfName.replace(rtrim, ''); // Adjust PartOfName without Unicode Characters    var cIndex = cSwatches.search(PartOfName), cSwatch;    if (cIndex == -1) return false;    cIndex = cSwatches.slice(0, cIndex).split("@$@").length - 1;    return cIndex;  }  for (var p = actualStartPage; p <= endingPage; p++) {    thePage = app.activeDocument.pages.item(p);    var primaryColorCode = thePage.textFrames.item("Primary Color Code").contents.toLowerCase();    var secondaryColorCode = thePage.textFrames.item("Secondary Color Code").contents.toLowerCase();    var accentColorCode = thePage.textFrames.item("Accent Color Code").contents.toLowerCase();    var matchGarmentColorCode = thePage.textFrames.item("Match to Garment Color Code").contents.toLowerCase();    var lightTonalColorCode = thePage.textFrames.item("Light Tonal Color Code").contents.toLowerCase();    var darkTonalColorCode = thePage.textFrames.item("Dark Tonal Color Code").contents.toLowerCase();    var neutralColorCode = thePage.textFrames.item("Neutral Color Code").contents.toLowerCase();    var greenColorCode = thePage.textFrames.item("Green Color Code").contents.toLowerCase();    var matchSwooshColorCode = thePage.textFrames.item("Match to Swoosh Color Code").contents.toLowerCase();        // Two Toned Shirt    var primary2ColorCode = thePage.textFrames.item("Primary 2 Color Code").contents.toLowerCase();    var secondary2ColorCode = thePage.textFrames.item("Secondary 2 Color Code").contents.toLowerCase();    var accent2ColorCode = thePage.textFrames.item("Accent 2 Color Code").contents.toLowerCase();    var matchGarment2ColorCode = thePage.textFrames.item("Match to Garment 2 Color Code").contents.toLowerCase();    var lightTonal2ColorCode = thePage.textFrames.item("Light Tonal 2 Color Code").contents.toLowerCase();    var darkTonal2ColorCode = thePage.textFrames.item("Dark Tonal 2 Color Code").contents.toLowerCase();    var neutral2ColorCode = thePage.textFrames.item("Neutral 2 Color Code").contents.toLowerCase();    var green2ColorCode = thePage.textFrames.item("Green 2 Color Code").contents.toLowerCase();﻿﻿    var matchSwoosh2ColorCode = thePage.textFrames.item("Match to Swoosh 2 Color Code").contents.toLowerCase();            if (app.activeDocument.pages.item(p).isValid == true) {      app.activeWindow.activePage = app.activeDocument.pages.item(p);    }    // Let the real fun begin    for (var i = startLayer; i < endLayer; i++) {      theDoc.activeLayer = theDoc.layers[i];      currentLayer = theDoc.activeLayer;        switch (currentLayer.name){            case "Main" :                if (primary2ColorCode.length < 5 ) {                thePage.textFrames.item("Primary 2 Color Code").remove();                 thePage.textFrames.item("Primary 2 Title").remove();                thePage.ovals.itemByName("Primary 2 Shape").remove();                // If Primary isn't Present Delete Color Coordinate Title                thePage.textFrames.item("Secondary Palette").remove();                }                if (secondary2ColorCode.length < 5 ) {                thePage.textFrames.item("Secondary 2 Color Code").remove();                 thePage.textFrames.item("Secondary 2 Title").remove();                thePage.ovals.itemByName("Secondary 2 Shape").remove();                }                       if (accent2ColorCode.length < 5 ) {                thePage.textFrames.item("Accent 2 Color Code").remove();                 thePage.textFrames.item("Accent 2 Title").remove();                thePage.ovals.itemByName("Accent 2 Shape").remove();                }                       if (matchGarment2ColorCode.length < 5 ) {                thePage.textFrames.item("Match to Garment 2 Color Code").remove();                 thePage.textFrames.item("Match to Garment 2 Title").remove();                thePage.ovals.itemByName("Match to Garment 2 Shape").remove();                }                            if (lightTonal2ColorCode.length < 5 ) {                thePage.textFrames.item("Light Tonal 2 Color Code").remove();                 thePage.textFrames.item("Light Tonal 2 Title").remove();                thePage.ovals.itemByName("Light Tonal 2 Shape").remove();                }                       if (darkTonal2ColorCode.length < 5 ) {                thePage.textFrames.item("Dark Tonal 2 Color Code").remove();                 thePage.textFrames.item("Dark Tonal 2 Title").remove();                thePage.ovals.itemByName("Dark Tonal 2 Shape").remove();                }                       if (neutral2ColorCode.length < 5 ) {                thePage.textFrames.item("Neutral 2 Color Code").remove();                 thePage.textFrames.item("Neutral 2 Title").remove();                thePage.ovals.itemByName("Neutral 2 Shape").remove();                }                      if (green2ColorCode.length < 5 ) {                thePage.textFrames.item("Green 2 Color Code").remove();                 thePage.textFrames.item("Green 2 Title").remove();                thePage.ovals.itemByName("Green 2 Shape").remove();                }                      if (matchSwoosh2ColorCode.length < 5 ) {                thePage.textFrames.item("Match to Swoosh 2 Color Code").remove();                 thePage.textFrames.item("Match to Swoosh 2 Title").remove();                thePage.ovals.itemByName("Match to Swoosh 2 Shape").remove();                }        }    }            }}